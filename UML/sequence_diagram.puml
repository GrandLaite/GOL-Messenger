@startuml Sequence_Diagram

actor User

participant "Frontend" as FE
participant "Backend" as BE
participant "Authentication Service" as Auth
participant "SQL Database" as SQL
participant "S3 File Storage" as S3
participant "Notification Service" as Notify

User -> FE: Вход в систему (отправка данных авторизации)
FE -> Auth: POST /login
Auth -> SQL: Проверка учетных данных
SQL --> Auth: Возвращение данных пользователя
Auth --> FE: Возвращение JWT токена

== Отправка сообщения ==

User -> FE: Отправить сообщение
FE -> BE: POST /messages (с JWT токеном)
BE -> Auth: Проверка JWT токена
Auth --> BE: Подтверждение аутентификации

BE -> SQL: Сохранение сообщения
SQL --> BE: Успешное сохранение

BE -> S3: Сохранение вложения (если есть)
S3 --> BE: Подтверждение сохранения

BE -> Notify: Уведомить получателя о новом сообщении
Notify --> BE: Подтверждение отправки уведомления
BE --> FE: Успешное отправление сообщения

== Получение списка сообщений ==

User -> FE: Получить сообщения
FE -> BE: GET /messages (с JWT токеном)
BE -> Auth: Проверка JWT токена
Auth --> BE: Подтверждение аутентификации

BE -> SQL: Получение сообщений пользователя
SQL --> BE: Возвращение списка сообщений
BE --> FE: Список сообщений

@enduml
